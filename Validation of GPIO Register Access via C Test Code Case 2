Test Case 2: GPIO Increment & Status Monitoring Test

Continuously increments GPIO value and reports it via UART.

#include <stdint.h>

#define UART_TX   (*(volatile unsigned int*)0x00400000)
#define GPIO_ADDR (*(volatile unsigned int*)0x20000000)

void putuartchar(char c) {
    UART_TX = c;
}

void print_str(const char *s) {
    while (*s) {
        putuartchar(*s++);
    }
}

void print_uint(unsigned int x) {
    char buf[10];
    int i = 0;

    if (x == 0) {
        putuartchar('0');
        return;
    }

    while (x > 0) {
        buf[i++] = '0' + (x % 10);
        x /= 10;
    }

    while (i--) putuartchar(buf[i]);
}

void delay() {
    for (volatile int i = 0; i < 100000; i++);
}

int main() {
    unsigned int count = 0;

    while (count < 5) {
        GPIO_ADDR = count;
        print_str("GPIO Counter Value: ");
        print_uint(GPIO_ADDR);
        putuartchar('\n');

        delay();
        count++;
    }

    return 0;
}
